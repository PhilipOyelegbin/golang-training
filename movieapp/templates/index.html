<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{.PageTitle}}</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-100 text-gray-800">
    <header class="bg-white shadow-md">
      <div
        class="flex flex-wrap gap-5 max-w-7xl mx-auto px-4 py-4 justify-center md:justify-between items-center"
      >
        <h1 class="text-2xl font-bold text-blue-600">ğŸ¬ {{.PageTitle}}</h1>
        <select
          id="countrySelect"
          class="border rounded px-3 py-2 focus:outline-none"
          onchange="changeCountry()"
        >
          <option value="">Select Country</option>
          <option value="us" {{if eq .CurrentCountry "us"}}selected{{end}}>ğŸ‡ºğŸ‡¸ United States</option>
          <option value="ng" {{if eq .CurrentCountry "ng"}}selected{{end}}>ğŸ‡³ğŸ‡¬ Nigeria</option>
          <option value="in" {{if eq .CurrentCountry "in"}}selected{{end}}>ğŸ‡®ğŸ‡³ India</option>
          <option value="gb" {{if eq .CurrentCountry "gb"}}selected{{end}}>ğŸ‡¬ğŸ‡§ United Kingdom</option>
          <option value="kr" {{if eq .CurrentCountry "kr"}}selected{{end}}>ğŸ‡°ğŸ‡· South Korea</option>
          <option value="jp" {{if eq .CurrentCountry "jp"}}selected{{end}}>ğŸ‡¯ğŸ‡µ Japan</option>
        </select>
      </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 py-8">
      <div class="flex flex-wrap justify-center md:justify-between items-center mb-4">
        <h2 class="text-xl font-semibold">Popular Movies</h2>
        <p class="text-gray-600">Showing results for: <span class="font-semibold text-blue-600">{{.CurrentCountry | upper}}</span></p>
      </div>

      <div
        id="movieGrid"
        class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"
      >
        {{range .Shows}}
        <figure class="bg-white shadow-md rounded-md overflow-hidden">
          <img
            src="{{.ImageSet.VerticalPoster.W600}}"
            alt="{{.Title}}"
            width="100"
            class="w-full h-64 object-cover"
          />
          <figcaption class="p-4 space-y-2">
            <h3 class="text-blue-600">{{.Title}}</h3>
            <p class="line-clamp-4">{{.Overview}}</p>
            <p>â­ {{.Rating}} â€¢ ğŸ“¢ {{.ReleaseYear}} â€¢ ğŸ¬ {{.ShowType}}</p>
          </figcaption>
        </figure>
        {{else}}
        <p class="text-rose-600">No shows found!</p>
        {{end}}
      </div>
    </main>

    <footer class="bg-slate-700 border-t py-4 text-center text-sm text-slate-200">
      &copy; 2025 Movie Explorer. All rights reserved.
    </footer>

    <script>
      function changeCountry() {
        const select = document.getElementById('countrySelect');
        const selectedCountry = select.value;
        
        if (selectedCountry) {
          // Reload the page with the selected country as a query parameter
          window.location.href = `/?country=${selectedCountry}`;
        }
      }

      // Set the current country as selected when page loads
      document.addEventListener('DOMContentLoaded', function() {
        const urlParams = new URLSearchParams(window.location.search);
        const country = urlParams.get('country') || 'us';
        const select = document.getElementById('countrySelect');
        select.value = country;
      });
    </script>
  </body>
</html>
